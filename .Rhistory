filter(
Topic_Description == "Cessation (Youth)", Year == input$years,
Gender == input$gender
)
joined_cessation_poverty_data_table <- left_join(cessation_table, poverty_data_table,
by = c("State")) %>%
select(
Year, State, Gender, Education, Data_Value,
ages_0_to_17_in_poverty_rate
) %>% na.omit()
})
# Q4 starts here
output$education <- renderPlot({
youth_tobacco_data_set <- get_youth_tobacco_data()
youth_tobacco_data_set <- youth_tobacco_data_set %>%
filter(Year == input$year) %>% # replace w/input year
filter(Topic_Description == "Cigarette Use (Youth)") %>%
filter(Gender == "Overall") %>%
filter(Response == input$feature) %>%
select(State, Education, Data_Value)
youth_tobacco_data_set <- spread(youth_tobacco_data_set,
key = "Education",
value = "Data_Value"
)
youth_poverty_data_set <- get_youth_poverty_data()
youth_poverty_data_set <- youth_poverty_data_set %>%
filter(year == input$year) %>%
ungroup() %>%
select(State = state_abbreviation, ages_0_to_17_in_poverty_rate)
joined_data_set <- left_join(youth_poverty_data_set, youth_tobacco_data_set, by = c("State"))
joined_data_set <- mutate(joined_data_set, poverty_rate = as.numeric(ages_0_to_17_in_poverty_rate))
percentage_bin_labels <- c("0% to 5%", "5% to 10%", "10% to 15%", "15% to 20%", "20% to 25%")
percentage_bins <- cut(joined_data_set$poverty_rate, c(0, 5, 10, 15, 20, 35), percentage_bin_labels)
joined_data_set <- mutate(joined_data_set, percentage_bins)
joined_data_set <- select(joined_data_set, State, poverty_rate, `High School`, `Middle School`, percentage_bins)
joined_data_set <- group_by(joined_data_set, percentage_bins)
joined_data_set <- na.omit(joined_data_set)
summarized_set <- summarize(joined_data_set,
High_School = mean(`High School`, na.rm = TRUE),
Middle_School = mean(`Middle School`, na.rm = TRUE)
)
summarized_set <- mutate(summarized_set, Difference = High_School - Middle_School)
summarized_set <- gather(summarized_set,
key = education, value = percentage,
-percentage_bins
)
summarized_set$education <- factor(summarized_set$education, levels = c("Middle_School", "High_School", "Difference"))
ggplot(data = summarized_set) +
geom_col(mapping = aes(x = percentage_bins, y = percentage, fill = education), position = "dodge")
})
}
runApp()
setwd("~/Desktop/info201/hw/ae5_final_project")
# output a data table
output$table <- renderTable({
# poverty_data_table <- poverty %>%
#   filter(year == input$years)
#
# # filter out tobaco data set
# cessation_table <- get_youth_tobacco_data() %>%
#   select(-Geo_Location, -Response) %>%
#   filter(
#     Topic_Description == "Cessation (Youth)", Year == input$years,
#     Gender == input$gender
#   )
#
# joined_cessation_poverty_data_table <- left_join(cessation, poverty,
#                                            by = c("State")) %>%
#   select(
#     Year, State, Gender, Education, Data_Value,
#     ages_0_to_17_in_poverty_rate
#   )
# # %>%
# #   arrange(-ages_0_to_17_in_poverty_rate) %>%
# #   head(n = 10)
poverty <- get_youth_poverty_data()
colnames(poverty)[colnames(poverty) == "state"] <- "states"
colnames(poverty)[colnames(poverty) == "state_abbreviation"] <- "State"
poverty_data_table <- poverty %>%
filter(year == input$years)
# filter out tobaco data set
cessation_table <- get_youth_tobacco_data() %>%
select(-Geo_Location, -Response) %>%
filter(
Topic_Description == "Cessation (Youth)", Year == input$years,
Gender == input$gender
)
joined_cessation_poverty_data_table <- left_join(cessation_table, poverty_data_table,
by = c("State")) %>%
select(
Year, State, Gender, Education, Data_Value,
ages_0_to_17_in_poverty_rate
) %>% na.omit()
})
library("shiny")
library("dplyr")
library("tidyr")
library("ggplot2")
source("analysis.R")
# define a `server` function
server <- function(input, output) {
# Q1 starts here
# Q2 starts here
# Q3 starts here
# rename poverty column
poverty <- get_youth_poverty_data()
colnames(poverty)[colnames(poverty) == "state"] <- "states"
colnames(poverty)[colnames(poverty) == "state_abbreviation"] <- "State"
output$cessation <- renderPlot({
# filter out poverty data set
poverty_data <- poverty %>%
filter(year == input$years)
# filter out tobaco data set
cessation <- get_youth_tobacco_data() %>%
select(-Geo_Location, -Response) %>%
filter(
Topic_Description == "Cessation (Youth)", Year == input$years,
Gender == input$gender
)
joined_cessation_poverty_data <- left_join(cessation, poverty,
by = c("State")
) %>%
select(
Year, State, Gender, Education, Data_Value,
ages_0_to_17_in_poverty_rate
)
joined_cessation_poverty_data <- mutate(joined_cessation_poverty_data,
poverty_rate = as.numeric(ages_0_to_17_in_poverty_rate)
)
poverty_perc_bin_labels <-
c(
"0% to 5%", "5% to 10%", "10% to 15%", "15% to 20%", "20% to 25%",
"25% to 30%", "30% to 35%"
)
percentage_bins <-
cut(
joined_cessation_poverty_data$poverty_rate,
c(0, 5, 10, 15, 20, 25, 30, 35), poverty_perc_bin_labels
)
ggplot(data = joined_cessation_poverty_data) +
geom_col(mapping = aes(
x = percentage_bins, y = Data_Value,
fill = Education
)) + labs(
title = paste(
"Smoking Cessation Vs. Poverty Rates for", input$gender,
"in the year of", input$years,
input$selected_year, "in the United States"
),
x = "Poverty Rate", y = "Cessation"
) +
scale_fill_brewer(palette = "Accent")
})
# output a data table
output$table <- renderTable({
# poverty_data_table <- poverty %>%
#   filter(year == input$years)
#
# # filter out tobaco data set
# cessation_table <- get_youth_tobacco_data() %>%
#   select(-Geo_Location, -Response) %>%
#   filter(
#     Topic_Description == "Cessation (Youth)", Year == input$years,
#     Gender == input$gender
#   )
#
# joined_cessation_poverty_data_table <- left_join(cessation, poverty,
#                                            by = c("State")) %>%
#   select(
#     Year, State, Gender, Education, Data_Value,
#     ages_0_to_17_in_poverty_rate
#   )
# # %>%
# #   arrange(-ages_0_to_17_in_poverty_rate) %>%
# #   head(n = 10)
poverty <- get_youth_poverty_data()
colnames(poverty)[colnames(poverty) == "state"] <- "states"
colnames(poverty)[colnames(poverty) == "state_abbreviation"] <- "State"
poverty_data_table <- poverty %>%
filter(year == input$years)
# filter out tobaco data set
cessation_table <- get_youth_tobacco_data() %>%
select(-Geo_Location, -Response) %>%
filter(
Topic_Description == "Cessation (Youth)", Year == input$years,
Gender == input$gender
)
joined_cessation_poverty_data_table <- left_join(cessation_table, poverty_data_table,
by = c("State")) %>%
select(
Year, State, Gender, Education, Data_Value,
ages_0_to_17_in_poverty_rate
) %>% na.omit()
})
# Q4 starts here
output$education <- renderPlot({
youth_tobacco_data_set <- get_youth_tobacco_data()
youth_tobacco_data_set <- youth_tobacco_data_set %>%
filter(Year == input$year) %>% # replace w/input year
filter(Topic_Description == "Cigarette Use (Youth)") %>%
filter(Gender == "Overall") %>%
filter(Response == input$feature) %>%
select(State, Education, Data_Value)
youth_tobacco_data_set <- spread(youth_tobacco_data_set,
key = "Education",
value = "Data_Value"
)
youth_poverty_data_set <- get_youth_poverty_data()
youth_poverty_data_set <- youth_poverty_data_set %>%
filter(year == input$year) %>%
ungroup() %>%
select(State = state_abbreviation, ages_0_to_17_in_poverty_rate)
joined_data_set <- left_join(youth_poverty_data_set, youth_tobacco_data_set, by = c("State"))
joined_data_set <- mutate(joined_data_set, poverty_rate = as.numeric(ages_0_to_17_in_poverty_rate))
percentage_bin_labels <- c("0% to 5%", "5% to 10%", "10% to 15%", "15% to 20%", "20% to 25%")
percentage_bins <- cut(joined_data_set$poverty_rate, c(0, 5, 10, 15, 20, 35), percentage_bin_labels)
joined_data_set <- mutate(joined_data_set, percentage_bins)
joined_data_set <- select(joined_data_set, State, poverty_rate, `High School`, `Middle School`, percentage_bins)
joined_data_set <- group_by(joined_data_set, percentage_bins)
joined_data_set <- na.omit(joined_data_set)
summarized_set <- summarize(joined_data_set,
High_School = mean(`High School`, na.rm = TRUE),
Middle_School = mean(`Middle School`, na.rm = TRUE)
)
summarized_set <- mutate(summarized_set, Difference = High_School - Middle_School)
summarized_set <- gather(summarized_set,
key = education, value = percentage,
-percentage_bins
)
summarized_set$education <- factor(summarized_set$education, levels = c("Middle_School", "High_School", "Difference"))
ggplot(data = summarized_set) +
geom_col(mapping = aes(x = percentage_bins, y = percentage, fill = education), position = "dodge")
})
}
runApp()
#
# joined_cessation_poverty_data_table <- left_join(cessation, poverty,
#                                            by = c("State")) %>%
#   select(
#     Year, State, Gender, Education, Data_Value,
#     ages_0_to_17_in_poverty_rate
#   )
# # %>%
# #   arrange(-ages_0_to_17_in_poverty_rate) %>%
# #   head(n = 10)
poverty <- get_youth_poverty_data()
library("shiny")
library("dplyr")
library("tidyr")
library("ggplot2")
source("analysis.R")
# define a `server` function
server <- function(input, output) {
# Q1 starts here
# Q2 starts here
# Q3 starts here
# rename poverty column
poverty <- get_youth_poverty_data()
colnames(poverty)[colnames(poverty) == "state"] <- "states"
colnames(poverty)[colnames(poverty) == "state_abbreviation"] <- "State"
output$cessation <- renderPlot({
# filter out poverty data set
poverty_data <- poverty %>%
filter(year == input$years)
# filter out tobaco data set
cessation <- get_youth_tobacco_data() %>%
select(-Geo_Location, -Response) %>%
filter(
Topic_Description == "Cessation (Youth)", Year == input$years,
Gender == input$gender
)
joined_cessation_poverty_data <- left_join(cessation, poverty,
by = c("State")
) %>%
select(
Year, State, Gender, Education, Data_Value,
ages_0_to_17_in_poverty_rate
)
joined_cessation_poverty_data <- mutate(joined_cessation_poverty_data,
poverty_rate = as.numeric(ages_0_to_17_in_poverty_rate)
)
poverty_perc_bin_labels <-
c(
"0% to 5%", "5% to 10%", "10% to 15%", "15% to 20%", "20% to 25%",
"25% to 30%", "30% to 35%"
)
percentage_bins <-
cut(
joined_cessation_poverty_data$poverty_rate,
c(0, 5, 10, 15, 20, 25, 30, 35), poverty_perc_bin_labels
)
ggplot(data = joined_cessation_poverty_data) +
geom_col(mapping = aes(
x = percentage_bins, y = Data_Value,
fill = Education
)) + labs(
title = paste(
"Smoking Cessation Vs. Poverty Rates for", input$gender,
"in the year of", input$years,
input$selected_year, "in the United States"
),
x = "Poverty Rate", y = "Cessation"
) +
scale_fill_brewer(palette = "Accent")
})
# output a data table
output$table <- renderTable({
# poverty_data_table <- poverty %>%
#   filter(year == input$years)
#
# # filter out tobaco data set
# cessation_table <- get_youth_tobacco_data() %>%
#   select(-Geo_Location, -Response) %>%
#   filter(
#     Topic_Description == "Cessation (Youth)", Year == input$years,
#     Gender == input$gender
#   )
#
# joined_cessation_poverty_data_table <- left_join(cessation, poverty,
#                                            by = c("State")) %>%
#   select(
#     Year, State, Gender, Education, Data_Value,
#     ages_0_to_17_in_poverty_rate
#   )
# # %>%
# #   arrange(-ages_0_to_17_in_poverty_rate) %>%
# #   head(n = 10)
poverty <- get_youth_poverty_data()
colnames(poverty)[colnames(poverty) == "state"] <- "states"
colnames(poverty)[colnames(poverty) == "state_abbreviation"] <- "State"
poverty_data_table <- poverty %>%
filter(year == input$years)
# filter out tobaco data set
cessation_table <- get_youth_tobacco_data() %>%
select(-Geo_Location, -Response) %>%
filter(
Topic_Description == "Cessation (Youth)", Year == input$years,
Gender == input$gender
)
joined_cessation_poverty_data_table <- left_join(cessation_table, poverty_data_table,
by = c("State")) %>%
select(
Year, State, Gender, Education, Data_Value,
ages_0_to_17_in_poverty_rate
) %>% na.omit() %>%  head(n = 10)
})
# Q4 starts here
output$education <- renderPlot({
youth_tobacco_data_set <- get_youth_tobacco_data()
youth_tobacco_data_set <- youth_tobacco_data_set %>%
filter(Year == input$year) %>% # replace w/input year
filter(Topic_Description == "Cigarette Use (Youth)") %>%
filter(Gender == "Overall") %>%
filter(Response == input$feature) %>%
select(State, Education, Data_Value)
youth_tobacco_data_set <- spread(youth_tobacco_data_set,
key = "Education",
value = "Data_Value"
)
youth_poverty_data_set <- get_youth_poverty_data()
youth_poverty_data_set <- youth_poverty_data_set %>%
filter(year == input$year) %>%
ungroup() %>%
select(State = state_abbreviation, ages_0_to_17_in_poverty_rate)
joined_data_set <- left_join(youth_poverty_data_set, youth_tobacco_data_set, by = c("State"))
joined_data_set <- mutate(joined_data_set, poverty_rate = as.numeric(ages_0_to_17_in_poverty_rate))
percentage_bin_labels <- c("0% to 5%", "5% to 10%", "10% to 15%", "15% to 20%", "20% to 25%")
percentage_bins <- cut(joined_data_set$poverty_rate, c(0, 5, 10, 15, 20, 35), percentage_bin_labels)
joined_data_set <- mutate(joined_data_set, percentage_bins)
joined_data_set <- select(joined_data_set, State, poverty_rate, `High School`, `Middle School`, percentage_bins)
joined_data_set <- group_by(joined_data_set, percentage_bins)
joined_data_set <- na.omit(joined_data_set)
summarized_set <- summarize(joined_data_set,
High_School = mean(`High School`, na.rm = TRUE),
Middle_School = mean(`Middle School`, na.rm = TRUE)
)
summarized_set <- mutate(summarized_set, Difference = High_School - Middle_School)
summarized_set <- gather(summarized_set,
key = education, value = percentage,
-percentage_bins
)
summarized_set$education <- factor(summarized_set$education, levels = c("Middle_School", "High_School", "Difference"))
ggplot(data = summarized_set) +
geom_col(mapping = aes(x = percentage_bins, y = percentage, fill = education), position = "dodge")
})
}
runApp()
library("shiny")
source("server.R")
home_page <- tabPanel(
"Home",
#  includeCSS("www/header.css"),
includeHTML("www/header.html"),
br(), br(), br(), br(), br(), br(), br(), br(), br(), br(), br(), br(), br(),
br(), br(), br(), br(),
titlePanel(h1("Study on Youth Poverty and Youth Smoking",
align = "center",
style = "font-size: 70px"
))
)
team_page <- tabPanel(
"Team",
# includeCSS("www/header.css"),
includeHTML("www/header.html"),
br(), br(), br(), br(), br(), br(), br(), br(), br(), br(), br(), br(), br(),
br(), br(), br(), br(),
titlePanel(h1("Our Team", align = "left", style = "font-size: 70px")),
br(), br(),
includeCSS("www/profile.css"),
includeHTML("www/profile.html")
)
sources_page <- tabPanel(
"Sources",
includeHTML("www/header.html"),
br(), br(), br(), br(), br(), br(), br(), br(), br(), br(), br(), br(), br(),
br(), br(), br(), br(), br(), br(),
includeHTML("www/sources.html")
)
question_one_page <- tabPanel("Poverty & Gender of Smokers")
question_three_page <- tabPanel(
"Poverty and Smoking Cessation",
sidebarLayout(
sidebarPanel(
selectInput(
inputId = "years",
label = "Select a year between 1992 and 2017",
choices = list(
"1999", "2000", "2001", "2002", "2003",
"2004", "2005", "2006", "2007", "2008",
"2009", "2010", "2011", "2012", "2013",
"2014", "2015", "2016", "2017"
)
),
radioButtons(
inputId = "gender",
label = "Select a gender of interest to compare against",
choices = list(
"Male",
"Female",
"Overall"
)
)
),
mainPanel(
tabsetPanel(
type = "tabs",
tabPanel("Table", tableOutput("table")),
tabPanel(
"plot", plotOutput(outputId = "cessation")
),
tabPanel(
"Analysis",
h4("For the states that has the highest cessation percentage in a given
year, what is its poverty level?"),
h5("Does the percentage of the attempt to quit smoking relate to poverty?"),
h5("We would like to know if income plays a role for children to make
the decision of whether to quit smoking"),
p("In anaanalizing ")
)
)
)
)
)
question_four_page <- tabPanel(
"Question 4",
sidebarLayout(
sidebarPanel(
selectInput(
inputId = "year",
label = "Select a year between 1992 and 2016",
choices = list(
"1999", "2000", "2001", "2002", "2003",
"2004", "2005", "2006", "2007", "2008",
"2009", "2010", "2011", "2012", "2013",
"2014", "2015", "2016", "2017"
)
),
radioButtons(
inputId = "feature",
label = "Select a feature of interest to compare against",
choices = list(
"Frequent",
"Ever",
"Current"
)
)
),
mainPanel(
plotOutput(
outputId = "education"
)
)
)
)
ui <- fluidPage(
includeCSS("www/bootstrap.css"),
includeCSS("www/header.css"),
navbarPage(
"",
home_page,
question_one_page,
tabPanel(
"Q2"
# Q2 Code starts here
),
question_three_page,
question_four_page,
team_page,
sources_page
)
)
runApp()
